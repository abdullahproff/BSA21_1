@startuml

skin rose

autonumber

actor User
participant MA as "Мобильное приложение"
participant Server
Database DB
activate User

User -> MA: Открыть "История прослушивания"
activate MA
MA -> Server: Запрос истории (GET /listening_history?user_id=123)
activate Server

Server -> Server: Валидация запроса (user_id, авторизация)
Server -> DB: SELECT * FROM listening_histories \nWHERE user_id=123 \nORDER BY listening_date DESC
activate DB
DB --> Server: Результаты истории прослушивания
deactivate DB

Server -> Server: Формирование JSON-ответа
Server --> MA: HTTP 200 OK + JSON с данными треков
deactivate Server

MA --> User: Отображение истории треков
deactivate MA

@enduml

